# Bazaruto Insurance Platform Configuration
# Copy this file to config.yaml and modify as needed

# Server Configuration
server:
  addr: ":8080"
  read_timeout: 30s
  write_timeout: 60s
  idle_timeout: 90s

# Database Configuration
# Supports both PostgreSQL and SQLite
db:
  # PostgreSQL example:
  # dsn: "postgres://user:password@localhost:5432/bazaruto?sslmode=disable"
  
  # SQLite example (for development):
  dsn: "file:./bazaruto_dev.db?cache=shared&mode=rwc"
  
  # Connection pool settings
  max_connections: 25
  min_connections: 5
  connect_timeout: 5s
  acquire_timeout: 3s
  max_lifetime: 30m
  idle_timeout: 10m

# Redis Configuration (optional, for caching and rate limiting)
redis:
  addr: "localhost:6379"
  password: ""
  db: 0
  dial_timeout: 2s
  read_timeout: 1s
  write_timeout: 1s

# Rate Limiting Configuration
rate:
  enabled: true
  provider: memory  # memory or redis
  per_minute: 120
  burst: 30
  key_strategy: ip  # ip, header, or user
  key_prefix: "rl:"
  ttl: 10m
  gc_interval: 5m
  
  # Advanced rate limiting policies
  policies:
    - name: quotes-write
      match:
        path_prefix: /v1/quotes
        methods: [POST]
      limits:
        - scope: global
          per_minute: 300
          burst: 60
        - scope: header
          header: X-API-Key
          per_minute: 120
          burst: 30
    - name: policies-read
      match:
        path_prefix: /v1/policies
        methods: [GET]
      limits:
        - scope: global
          per_minute: 1000
          burst: 200

# Observability Configuration
observability:
  log:
    level: info  # debug, info, warn, error
    format: json  # json or text
  metrics:
    enabled: true
    path: /metrics
  tracing:
    enabled: false  # Set to true for production tracing
    endpoint: "localhost:4317"
    service_name: bazaruto

# Email Configuration (for notifications)
email:
  enabled: false
  provider: smtp  # smtp or sendgrid
  smtp:
    host: "localhost"
    port: 587
    username: ""
    password: ""
    from: "noreply@bazaruto.com"
    tls: true
  sendgrid:
    api_key: ""
    from: "noreply@bazaruto.com"

# Webhook Configuration
webhooks:
  enabled: true
  timeout: 30s
  max_retries: 3
  retry_delay: 5s

# Security Configuration
security:
  cors:
    enabled: true
    origins: ["http://localhost:3000", "https://app.bazaruto.com"]
    methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
    headers: ["Content-Type", "Authorization", "X-API-Key"]
    credentials: true
  csrf:
    enabled: false
    secret: "your-csrf-secret"
  headers:
    - name: X-Content-Type-Options
      value: nosniff
    - name: X-Frame-Options
      value: DENY
    - name: X-XSS-Protection
      value: "1; mode=block"
